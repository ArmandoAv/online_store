# Scripts with amount updates

update_details = """UPDATE ORDERDETAILS T1
SET T1.UNITPRICE = (SELECT T2.PRICE
                    FROM PRODUCTS T2
                    WHERE T1.PRODUCTID = T2.PRODUCTID)"""

update_orders = """UPDATE ORDERS ORD
SET TOTALAMOUNT = (
    SELECT COALESCE(SUM(DET.QUANTITY * DET.UNITPRICE), 0)
    FROM ORDERDETAILS DET
    WHERE DET.ORDERID = ORD.ORDERID
)
WHERE EXISTS (
    SELECT 1
    FROM ORDERDETAILS DET
    WHERE DET.ORDERID = ORD.ORDERID
)"""
